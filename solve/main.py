import os.path
import win32com.client as wincl


def run_clip(count, n, ind_res):
    xl.Application.Run("задача1.xlsm!Module2.Clipping", str(ind_res + count), str(n))
    xl.Application.Run("задача1.xlsm!Module1.CopyPaste")
    val = [r[0].value for r in sheet.Range("B33:AL33")]
    ind = [i for i in range(1, 38) if val[i - 1] == 0]
    return ind


count = int(input())
test_arr = []
ind_res = 34  # строка с новым решением
n = 1  # для получения нового теста
xl = wincl.Dispatch("Excel.Application")
workbook = xl.Workbooks.Open(os.path.abspath
                             ('./files/задача1.xlsm'), ReadOnly=1)
sheet = workbook.ActiveSheet
xl.Application.Run("задача1.xlsm!Module1.Solve")
xl.Application.Run("задача1.xlsm!Module1.CopyPaste")
n += 1
val = [r[0].value for r in sheet.Range("B33:AL33")]
ind = [i for i in range(1, 37) if val[i - 1] == 0]
test_arr.append(ind)

if count > 1:
    for i in range(2, count + 1):
        test_arr.append(run_clip(i - 1, n, ind_res))
        n += 1
print(test_arr)

os.system("taskkill.exe /F /IM " + "EXCEL.exe")
del xl

tests = [[4, 7, 15, 30, 31, 35], [2, 4, 12, 30, 31, 33], [2, 4, 9, 31, 33, 34], [2, 8, 9, 29, 31, 35],
         [2, 4, 14, 31, 33, 34], [2, 8, 15, 23, 31, 37], [7, 8, 15, 24, 28, 32], [4, 13, 15, 23, 31, 32],
         [8, 13, 15, 21, 33, 34], [2, 8, 9, 27, 31, 37], [1, 2, 15, 17, 25, 31], [7, 8, 15, 31, 33, 34],
         [2, 8, 9, 20, 24, 30], [2, 15, 17, 20, 28, 34], [2, 8, 9, 20, 28, 33], [2, 4, 15, 23, 31, 37],
         [2, 8, 9, 21, 33, 34], [2, 8, 9, 21, 24, 30], [2, 9, 17, 22, 24, 34], [8, 13, 15, 30, 31, 33],
         [4, 7, 19, 23, 31, 36], [4, 7, 19, 23, 24, 36], [2, 4, 9, 31, 35, 37], [1, 2, 4, 31, 33, 37], [4, 7, 15, 31, 33, 34],
         [16, 17, 19, 31, 34, 35], [4, 7, 15, 30, 31, 33], [16, 17, 19, 22, 29, 33], [2, 4, 12, 21, 24, 30],
         [15, 16, 17, 31, 35, 37], [4, 7, 19, 26, 32, 33], [2, 15, 17, 26, 28, 31], [1, 4, 7, 15, 25, 31],
         [2, 4, 5, 21, 31, 37],
         [2, 15, 17, 30, 31, 35], [4, 5, 13, 26, 32, 33], [4, 5, 7, 26, 32, 33], [1, 2, 4, 22, 31, 37], [2, 4, 15, 31, 33, 37],
         [2, 4, 15, 24, 31, 37], [8, 13, 15, 27, 31, 37], [4, 12, 13, 15, 22, 24], [4, 13, 19, 26, 32, 33],
         [2, 8, 9, 25, 31, 33], [2, 4, 15, 31, 35, 37], [5, 8, 12, 16, 22, 24], [7, 8, 15, 23, 31, 32], [7, 8, 15, 23, 24, 37],
         [2, 4, 9, 26, 32, 33], [15, 16, 17, 26, 32, 33], [4, 7, 15, 22, 29, 33], [2, 8, 9, 20, 24, 29],
         [8, 13, 15, 24, 26, 32], [2, 4, 9, 25, 31, 33], [2, 15, 17, 25, 31, 35], [2, 4, 9, 25, 27, 31],
         [2, 4, 26, 27, 31, 37], [2, 15, 17, 31, 33, 34], [1, 2, 4, 22, 34, 37], [2, 15, 17, 20, 29, 33], [2, 4, 9, 31, 33, 37],
         [2, 8, 9, 12, 22, 24], [2, 4, 15, 27, 31, 37], [1, 2, 4, 22, 26, 37], [2, 15, 17, 31, 33, 37], [2, 4, 8, 31, 33, 37],
         [2, 15, 17, 21, 33, 34], [4, 13, 15, 24, 31, 32], [1, 2, 4, 22, 35, 37], [4, 13, 15, 24, 31, 37],
         [2, 4, 9, 31, 34, 35],
         [2, 15, 17, 23, 31, 36], [2, 4, 13, 23, 31, 36]]
